module darcy_impes_leaching_types

#include "fdebug.h"

  use spud
  use fields
  use state_module
  use fldebug
  use global_parameters, only: OPTION_PATH_LEN, FIELD_NAME_LEN
  
  
  implicit none
  private

  public :: leach_chemical_type, &
            leach_chemical_prog_sfield_src

  !!----Leaching chemical options-----------------------------------------------------------------------
    !options for the bulk fluid dependency of the rate constant
  type bulk_fluid_type
     character(len=FIELD_NAME_LEN) :: lc_name
     real :: order
  end type bulk_fluid_type
  
  !options for the rate constant, arrhenius type
  type arrhenius_rate_constant_type
     real :: ae !activation energy
     real :: gc !gas constant
     type(bulk_fluid_type), dimension(:), pointer :: bulk => null()
  end type arrhenius_rate_constant_type
  
  type leaching_internal_algorithm_type
     type(scalar_field), pointer :: dcdt => null() !the change rate of concentration per volume of heap
  end type leaching_internal_algorithm_type
  
  type leaching_arrhenius_reaction_type
     type(scalar_field), pointer :: dcdt => null() !the change rate of concentration per volume of heap
     type(arrhenius_rate_constant_type), dimension(1) :: ak
  end type leaching_arrhenius_reaction_type
  
  type leaching_semi_empirical_model_type
     type(scalar_field), pointer :: dcdt => null() !the change rate of concentration per volume of heap
     type(scalar_field), pointer :: ex_r => null() !the extraction rate
     type(scalar_field), pointer :: ex => null() !the extraction
     type(scalar_field), pointer :: mc => null() !the molar concentration of the mineral species per volume of heap
     type(arrhenius_rate_constant_type), dimension(1) :: ak
  end type leaching_semi_empirical_model_type
  
  !options for leaching solution phase reaction
  type leaching_solution_phase_type
     type(leaching_internal_algorithm_type):: jaro  !jarocite precipitation
     type(leaching_internal_algorithm_type)::oxdi !oxygen dissolution
     type(leaching_arrhenius_reaction_type)::feox !dissolution of chalcopyrite
  end type leaching_solution_phase_type
  
  !options for leaching mineral dissolution
  type leaching_mineral_dissolution_type
     type(leaching_internal_algorithm_type):: sulf  !elemental sulfur dissolution
     type(leaching_semi_empirical_model_type)::pyri !dissolution of pyrite
     type(leaching_semi_empirical_model_type)::chal !dissolution of chalcopyrite
  end type leaching_mineral_dissolution_type
  
  !options for leach_chem_src_type for generic prog leach chemical src
  type leach_chem_src_type
    !The source name of the prog sfield from chemical reactions
    character(len=FIELD_NAME_LEN) :: lc_name
    !the stoichiometric factor of the species in the reaction equation 
    real :: sto_factor
    type(scalar_field), pointer :: sfield => null()
  end type leach_chem_src_type
  
  !options under darcy_impes_generic_prog_sfield_type
  type leach_chemical_prog_sfield_src
    logical :: have_sol_src = .false. !if have the chemical source terms from solution phase
    logical :: have_dis_src = .false. !if have the chemical source terms from mineral disslotion
    !the array for the source terms from solution phase
    type(leach_chem_src_type), dimension(:), pointer :: sfield_sol_src =>null()
    !the array for the source terms from mineral dissolution
    type(leach_chem_src_type), dimension(:), pointer :: sfield_dis_src =>null()
  end type leach_chemical_prog_sfield_src
  
  !options for leaching chemical model under darcy_impes_type                                                       
  type leach_chemical_type                                                                
    logical:: have_leach_chem_model = .false.  !if have leaching chemical model of this material phase
    logical:: have_dis = .false. !if have leaching minderal dissolution
    logical:: have_sol = .false. !if have leaching solution phase reactions
    type(leaching_mineral_dissolution_type):: dis 
    type(leaching_solution_phase_type) :: sol 
    type(scalar_field) :: liquid_temperature
    type(scalar_field) :: air_temperature
    type(scalar_field) :: rock_temperature
   end type leach_chemical_type
  
  
  
  

  

  
  

  

  

  
  
end module
