#!/bin/bash
# Determine the version of Fluidity

# fluidity_VERSION is set during configuration through CMake

# Usage:
# bin/version-info [FILENAME]
#   If FILENAME is not specified, print determination of fluidity
#   version to stdout.
#   Otherwise, write the fluidity version as C #defines to FILENAME.
#   The file is only written to if the version existing in the file
#   differs from the one we've just figured out.

PACKAGE_VERSION="@fluidity_VERSION@"

if [ x"$@" = x"" ]; then
    echo $PACKAGE_VERSION
else
    grep "\"${PACKAGE_VERSION}\"" $@ >/dev/null 2>&1 ||
    (printf "#ifndef _FLUIDITY_VERSION_H\n\
#define _FLUIDITY_VERSION_H\n\
#define __FLUIDITY_VERSION__ \"${PACKAGE_VERSION}\"\n\
#endif /* _FLUIDITY_VERSION_H */\n" > $@ &&
    echo "DEFINE __FLUIDITY_VERSION__")
fi
