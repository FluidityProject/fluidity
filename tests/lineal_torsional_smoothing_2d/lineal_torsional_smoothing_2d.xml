<?xml version="1.0" encoding="UTF-8" ?>

<testproblem>
  <name>lineal torsional smoothing 2d</name>
  <owner userid="tmcmanus"/>
  <tags>flml radapt</tags>
    <problem_definition length="short" nprocs="1">
    <command_line>fluidity -v2 -l lineal_torsional_smoothing_2d.flml</command_line>
  </problem_definition>  
  <variables>  
    <variable name="solvers_converged" language="python">
import os
files = os.listdir("./")
solvers_converged = not "matrixdump" in files and not "matrixdump.info" in files
    </variable>
    <variable name="mingridvelocity_x_2d" language="python">
from fluidity_tools import stat_parser
s=stat_parser("lineal_torsional_smoothing_2d.stat")
mingridvelocity_x_2d=s["Fluid"]["GridVelocity%1"]["min"][-1]
    </variable>
    <variable name="maxgridvelocity_x_2d" language="python">
from fluidity_tools import stat_parser
s=stat_parser("lineal_torsional_smoothing_2d.stat")
maxgridvelocity_x_2d=s["Fluid"]["GridVelocity%1"]["max"][-1]
    </variable>
    <variable name="mingridvelocity_y_2d" language="python">
from fluidity_tools import stat_parser
s=stat_parser("lineal_torsional_smoothing_2d.stat")
mingridvelocity_y_2d=s["Fluid"]["GridVelocity%2"]["min"][-1]
    </variable>
    <variable name="maxgridvelocity_y_2d" language="python">
from fluidity_tools import stat_parser
s=stat_parser("lineal_torsional_smoothing_2d.stat")
maxgridvelocity_y_2d=s["Fluid"]["GridVelocity%2"]["max"][-1]
    </variable>
  </variables>    
  <pass_tests> 
    <test name="Solvers converged" language="python">
      assert(solvers_converged)
    </test>
    <test name="Check minimum grid velocity in x-direction." language="python">
print 'min(GridVelocity%1)_2d = ', mingridvelocity_x_2d
assert mingridvelocity_x_2d &lt; 0 and mingridvelocity_x_2d &gt; -0.1
    </test>
    <test name="Check maximum grid velocity in x-direction." language="python">
print 'max(GridVelocity%1)_2d = ', maxgridvelocity_x_2d
assert maxgridvelocity_x_2d &gt; 0 and maxgridvelocity_x_2d &lt; 0.1 
    </test>
    <test name="Check minimum grid velocity in y-direction." language="python">
print 'min(GridVelocity%2)_2d = ', mingridvelocity_y_2d
assert mingridvelocity_y_2d &lt; 0 and mingridvelocity_y_2d &gt; -0.2
    </test>
    <test name="Check maximum grid velocity in y-direction." language="python">
print 'max(GridVelocity%2)_2d = ', maxgridvelocity_y_2d
assert maxgridvelocity_y_2d &gt; 0 and maxgridvelocity_y_2d &lt; 0.2 
    </test>
  </pass_tests>
</testproblem>
